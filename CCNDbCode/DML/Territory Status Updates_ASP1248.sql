/********************************************************************************
This script  update status for 47 territories as per Pats request

Created : 04/22/2019 jxc517/sxg151 CCN Project Team....
********************************************************************************/

SELECT * FROM CODE_DETAIL WHERE CODE_HEADER_NAME = 'STATUS_CODE' AND CODE_DETAIL_VALUE IN ('P', 'C', 'X');
SELECT * FROM STATUS WHERE COST_CENTER_CODE IN ('716510','717784','717959','71R102','71R103','71R104','71R105','71R106','71R107','71R108','71R109','71R110','71R111','71R112','71R113','71R114','71R115','71R117','71R118','71R119','71R120','71R121','71R122','71R123','71R124','71R125','71R126','71R127','71R128','71R129','71R130','71R131','71R132','71R133','71R134','71R135','71R136','71R137','71R138','71R139','71R140','71R460','71R461','71R462','71R463','71R464','71R465') AND EXPIRATION_DATE IS NULL ORDER BY 1;
SELECT * FROM COST_CENTER WHERE COST_CENTER_CODE IN ('717784','717959') ORDER BY 1; --close date should match closed new status effective date
SELECT * FROM TERRITORY WHERE COST_CENTER_CODE IN ('717784','717959') ORDER BY 1;
SELECT * FROM CUSTOMER_TAXID_VW_COSTCNTR WHERE ORA_COSTCTR IN ('717784', '717959');
SELECT COMMON_TOOLS.IS_CC_HAVING_CSTMR_ACCNTS_FNC('717784') FROM DUAL;
SELECT COMMON_TOOLS.IS_CC_HAVING_CSTMR_ACCNTS_FNC('717959') FROM DUAL;


DECLARE
    OUT_ID     NUMBER;
BEGIN
    POS_DATA_GENERATION.SET_FLAG_POLLING_BULK_LOADS('MANUAL-ASP-1248', OUT_ID);

    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '716510' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('716510','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '717784' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('717784','X','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '717959' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('717959','X','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R102' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R102','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R103' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R103','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R104' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R104','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R105' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R105','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R106' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R106','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R107' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R107','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R108' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R108','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R109' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R109','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R110' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R110','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R111' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R111','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R112' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R112','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R113' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R113','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R114' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R114','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R115' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R115','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R117' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R117','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R118' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R118','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R119' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R119','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R120' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R120','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R121' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R121','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R122' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R122','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R123' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R123','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R124' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R124','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R125' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R125','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R126' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R126','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R127' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R127','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R128' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R128','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R129' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R129','P','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R130' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R130','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R131' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R131','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R132' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R132','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R133' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R133','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R134' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R134','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R135' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R135','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R136' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R136','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R137' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R137','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R138' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R138','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R139' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R139','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R140' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R140','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R460' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R460','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R461' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R461','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R462' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R462','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R463' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R463','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R464' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R464','C','01-JAN-2019',NULL);
    UPDATE STATUS SET EXPIRATION_DATE = '31-DEC-2018' WHERE COST_CENTER_CODE = '71R465' AND EXPIRATION_DATE IS NULL;
    INSERT INTO STATUS VALUES ('71R465','C','01-JAN-2019',NULL);

    UPDATE TERRITORY SET HOME_STORE = NULL WHERE COST_CENTER_CODE IN ('717784','717959');
    UPDATE COST_CENTER SET CLOSE_DATE = '01-JAN-2019' WHERE COST_CENTER_CODE IN ('717784','717959');

    POS_DATA_GENERATION.RESET_FLAG_POLLING_BULK_LOADS(OUT_ID);
END;

COMMIT;

--validation scritps
SELECT * FROM STATUS WHERE COST_CENTER_CODE IN ('716510','717784','717959','71R102','71R103','71R104','71R105','71R106','71R107','71R108','71R109','71R110','71R111','71R112','71R113','71R114','71R115','71R117','71R118','71R119','71R120','71R121','71R122','71R123','71R124','71R125','71R126','71R127','71R128','71R129','71R130','71R131','71R132','71R133','71R134','71R135','71R136','71R137','71R138','71R139','71R140','71R460','71R461','71R462','71R463','71R464','71R465') AND EXPIRATION_DATE IS NULL ORDER BY 1;

--utility
SELECT * FROM POS_DOWNLOADS ORDER BY 1 DESC;
SELECT * FROM POS_DOWNLOADS_BULK_LOADS_LKUP ORDER BY MAINTENANCE_DATE_START DESC;