/*
SELECT * FROM ADDRESS_USA WHERE (COST_CENTER_CODE, ADDRESS_TYPE) IN (
SELECT COST_CENTER_CODE, ADDRESS_TYPE
  FROM ADDRESS_USA
 --WHERE COST_CENTER_CODE = '789381';
 WHERE EXPIRATION_DATE IS NULL
 GROUP BY COST_CENTER_CODE, ADDRESS_TYPE
 HAVING COUNT(*) > 1)
 ORDER BY 1,2,3,4;
SELECT * FROM ADDRESS_CAN WHERE (COST_CENTER_CODE, ADDRESS_TYPE) IN (
SELECT COST_CENTER_CODE, ADDRESS_TYPE
  FROM ADDRESS_CAN
 --WHERE COST_CENTER_CODE = '789381';
 WHERE EXPIRATION_DATE IS NULL
 GROUP BY COST_CENTER_CODE, ADDRESS_TYPE
 HAVING COUNT(*) > 1)
 ORDER BY 1,2,3,4;
SELECT * FROM ADDRESS_MEX WHERE (COST_CENTER_CODE, ADDRESS_TYPE) IN (
SELECT COST_CENTER_CODE, ADDRESS_TYPE
  FROM ADDRESS_MEX
 --WHERE COST_CENTER_CODE = '789381';
 WHERE EXPIRATION_DATE IS NULL
 GROUP BY COST_CENTER_CODE, ADDRESS_TYPE
 HAVING COUNT(*) > 1)
 ORDER BY 1,2,3,4;
 SELECT * FROM ADDRESS_OTHER WHERE (COST_CENTER_CODE, ADDRESS_TYPE) IN (
SELECT COST_CENTER_CODE, ADDRESS_TYPE
  FROM ADDRESS_OTHER
 --WHERE COST_CENTER_CODE = '789381';
 WHERE EXPIRATION_DATE IS NULL
 GROUP BY COST_CENTER_CODE, ADDRESS_TYPE
 HAVING COUNT(*) > 1)
 ORDER BY 1,2,3,4;
*/


/*******************************************************************************
--Correcting the duplicate records for ADDRESS

Created : 03/20/2015 jxc517 CCN Project....
*******************************************************************************/
SELECT * FROM ADDRESS_USA WHERE COST_CENTER_CODE IN ('789381','789766','789773') AND EFFECTIVE_DATE = '01-JAN-2099';
--3 Row(s) Selected
DELETE FROM ADDRESS_USA WHERE COST_CENTER_CODE IN ('789381','789766','789773') AND EFFECTIVE_DATE = '01-JAN-2099';
--3 Row(s) Selected

SELECT * FROM ADDRESS_USA WHERE COST_CENTER_CODE IN ('OO7881','OO7882') AND EFFECTIVE_DATE = '09-JAN-1992';
--2 Row(s) Selected
UPDATE ADDRESS_USA SET EXPIRATION_DATE = '14-FEB-1992' WHERE COST_CENTER_CODE IN ('OO7881','OO7882') AND EFFECTIVE_DATE = '09-JAN-1992';
--2 Row(s) Updated

COMMIT;
