--Below script will terminate the current status records and insert new records with status as '1'
SELECT *
  FROM STATUS
 WHERE COST_CENTER_CODE IN 
('701508','701509','701510','701511','701512','701513','701514','701515','701516','701517','701518','701519','701520','701521','701522','701523','701524','701525',
'701526','701529','701530','701531','701533','701534','701535','701536','701537','701538','701539','701541','701542','701543','701544','701545','701546','701548',
'701549','701550','701551','701552','701553','701554','701555','701556','701557','701559','701560','701561','701564','701567','701570','701571','701572','701573',
'701574','701576','701577','701578','701579','701580','701581','701582','701583','701586','701587','701588','701589','701590','701591','701592','701593','701594',
'701595','701596','701597','701598','701600','701601','701602','701603','701604','701605','701606','701607','701608','701609','701610','701612','701613','701614',
'701615','701616','701617','701618','701619','701622','701623','701624','701625','701626','701629','701630','701631','701632','701633','701634','701635','701636',
'701638','701640','701641','701642','701644','701645','701646','701647','701648','701649','701651','701652','701653','701654','701655','701656','701657','701658',
'701659','701660','701661','701662','701663','701664','701665','701667','701668','701669','701670','701671','701672','701673','701674','701675','701676','701677',
'701680','701681','701682','701683','701684','701685','701686','701689','701690','701691','701692','701693','701694','701696','701697','701699','701700','701701',
'702960','702961','702963','702964','702965','702966','702967','702968','702969','702970','702971','702974','702975','702976','702977','702978','702980','702981',
'702982','702983','702985','702988','702989','702990','702991','702992','702995','702996','702997','703542','703543','703546','703550','703552','703553','703554',
'703555','703556','703557','703559','703561','703562','703563','703564','703565','703566','703569','768845','768846','768847','768849','768850','768851','768852',
'768853','768854','768855','768856','768857','768858','768859','768860','768861','768862','768863','768864','768865','768866','768867','768868','768869','768870',
'768871','768872','768873','768874','768875','768876','768877','768878','768879','768880','768881','768882','768883','768884','768885','768886','768887','768888',
'768889','768890','768892','768893','768894','768895','768896','768897','768901','768903','768904','768905','768906','768907','768908','768909','768910','768911',
'768913','768914','768916','768917','768918','768919','768920','768921','768922','768923','768924','768925','768926','768928','768930','768931')
AND EXPIRATION_DATE IS NULL;
/*
Production data before updates
COST_CENTER_CODE STATUS_CODE EFFECTIVE_DATE       EXPIRATION_DATE    
---------------- ----------- -------------------- --------------------
701660           4           01-JAN-2015 00:00:00                      
703542           4           01-JAN-2015 00:00:00                      
703552           4           01-JAN-2015 00:00:00                      
703557           4           01-JAN-2015 00:00:00                      
703561           4           01-JAN-2015 00:00:00                      
703566           4           01-JAN-2015 00:00:00                      
703546           4           01-JAN-2015 00:00:00                      
703555           4           01-JAN-2015 00:00:00                      
703562           4           01-JAN-2015 00:00:00                      
703569           4           01-JAN-2015 00:00:00                      
701509           4           01-JAN-2015 00:00:00                      
701511           4           01-JAN-2015 00:00:00                      
701518           4           01-JAN-2015 00:00:00                      
701519           4           01-JAN-2015 00:00:00                      
701535           4           01-JAN-2015 00:00:00                      
701539           4           01-JAN-2015 00:00:00                      
701541           4           01-JAN-2015 00:00:00                      
701544           4           01-JAN-2015 00:00:00                      
701548           4           01-JAN-2015 00:00:00                      
701553           4           01-JAN-2015 00:00:00                      
701554           4           01-JAN-2015 00:00:00                      
702965           4           01-JAN-2015 00:00:00                      
701559           4           01-JAN-2015 00:00:00                      
701561           4           01-JAN-2015 00:00:00                      
702971           4           01-JAN-2015 00:00:00                      
701577           4           01-JAN-2015 00:00:00                      
702985           4           01-JAN-2015 00:00:00                      
701580           4           01-JAN-2015 00:00:00                      
701590           4           01-JAN-2015 00:00:00                      
702991           4           01-JAN-2015 00:00:00                      
701595           4           01-JAN-2015 00:00:00                      
701598           4           01-JAN-2015 00:00:00                      
701606           4           01-JAN-2015 00:00:00                      
701613           4           01-JAN-2015 00:00:00                      
701616           4           01-JAN-2015 00:00:00                      
701617           4           01-JAN-2015 00:00:00                      
701618           4           01-JAN-2015 00:00:00                      
701636           4           01-JAN-2015 00:00:00                      
701641           4           01-JAN-2015 00:00:00                      
701645           4           01-JAN-2015 00:00:00                      
701651           4           01-JAN-2015 00:00:00                      
701656           4           01-JAN-2015 00:00:00                      
701664           4           01-JAN-2015 00:00:00                      
701670           4           01-JAN-2015 00:00:00                      
701675           4           01-JAN-2015 00:00:00                      
701682           4           01-JAN-2015 00:00:00                      
701690           4           01-JAN-2015 00:00:00                      
701692           4           01-JAN-2015 00:00:00                      
701693           4           01-JAN-2015 00:00:00                      
701701           4           01-JAN-2015 00:00:00                      
768850           4           01-JAN-2015 00:00:00                      
768856           4           01-JAN-2015 00:00:00                      
768863           4           01-JAN-2015 00:00:00                      
768866           4           01-JAN-2015 00:00:00                      
768870           4           01-JAN-2015 00:00:00                      
768879           4           01-JAN-2015 00:00:00                      
768884           4           01-JAN-2015 00:00:00                      
768887           4           01-JAN-2015 00:00:00                      
768903           4           01-JAN-2015 00:00:00                      
768905           4           01-JAN-2015 00:00:00                      
768919           4           01-JAN-2015 00:00:00                      
768911           4           01-JAN-2015 00:00:00                      
768922           4           01-JAN-2015 00:00:00                      
768923           4           01-JAN-2015 00:00:00                      
768924           4           01-JAN-2015 00:00:00                      
768930           4           01-JAN-2015 00:00:00                      
701510           4           01-JAN-2015 00:00:00                      
701515           4           01-JAN-2015 00:00:00                      
701516           4           01-JAN-2015 00:00:00                      
701520           4           01-JAN-2015 00:00:00                      
701524           4           01-JAN-2015 00:00:00                      
701549           4           01-JAN-2015 00:00:00                      
701552           4           01-JAN-2015 00:00:00                      
702960           4           01-JAN-2015 00:00:00                      
702964           4           01-JAN-2015 00:00:00                      
701573           4           01-JAN-2015 00:00:00                      
701574           4           01-JAN-2015 00:00:00                      
702980           4           01-JAN-2015 00:00:00                      
701576           4           01-JAN-2015 00:00:00                      
701578           4           01-JAN-2015 00:00:00                      
702988           4           01-JAN-2015 00:00:00                      
701581           4           01-JAN-2015 00:00:00                      
701591           4           01-JAN-2015 00:00:00                      
702989           4           01-JAN-2015 00:00:00                      
701602           4           01-JAN-2015 00:00:00                      
701608           4           01-JAN-2015 00:00:00                      
701609           4           01-JAN-2015 00:00:00                      
701612           4           01-JAN-2015 00:00:00                      
701619           4           01-JAN-2015 00:00:00                      
701622           4           01-JAN-2015 00:00:00                      
701624           4           01-JAN-2015 00:00:00                      
701633           4           01-JAN-2015 00:00:00                      
701634           4           01-JAN-2015 00:00:00                      
701647           4           01-JAN-2015 00:00:00                      
701653           4           01-JAN-2015 00:00:00                      
701661           4           01-JAN-2015 00:00:00                      
701667           4           01-JAN-2015 00:00:00                      
701672           4           01-JAN-2015 00:00:00                      
701677           4           01-JAN-2015 00:00:00                      
768855           4           01-JAN-2015 00:00:00                      
768862           4           01-JAN-2015 00:00:00                      
768867           4           01-JAN-2015 00:00:00                      
768869           4           01-JAN-2015 00:00:00                      
768872           4           01-JAN-2015 00:00:00                      
768873           4           01-JAN-2015 00:00:00                      
768876           4           01-JAN-2015 00:00:00                      
768878           4           01-JAN-2015 00:00:00                      
768881           4           01-JAN-2015 00:00:00                      
768885           4           01-JAN-2015 00:00:00                      
768888           4           01-JAN-2015 00:00:00                      
768893           4           01-JAN-2015 00:00:00                      
768896           4           01-JAN-2015 00:00:00                      
768897           4           01-JAN-2015 00:00:00                      
768928           4           01-JAN-2015 00:00:00                      
768925           4           01-JAN-2015 00:00:00                      
768931           4           01-JAN-2015 00:00:00                      
701512           4           01-JAN-2015 00:00:00                      
701513           4           01-JAN-2015 00:00:00                      
701523           4           01-JAN-2015 00:00:00                      
701526           4           01-JAN-2015 00:00:00                      
701534           4           01-JAN-2015 00:00:00                      
701537           4           01-JAN-2015 00:00:00                      
701538           4           01-JAN-2015 00:00:00                      
701542           4           01-JAN-2015 00:00:00                      
701551           4           01-JAN-2015 00:00:00                      
702963           4           01-JAN-2015 00:00:00                      
701560           4           01-JAN-2015 00:00:00                      
701564           4           01-JAN-2015 00:00:00                      
702969           4           01-JAN-2015 00:00:00                      
701567           4           01-JAN-2015 00:00:00                      
702974           4           01-JAN-2015 00:00:00                      
701572           4           01-JAN-2015 00:00:00                      
702978           4           01-JAN-2015 00:00:00                      
702982           4           01-JAN-2015 00:00:00                      
702983           4           01-JAN-2015 00:00:00                      
701579           4           01-JAN-2015 00:00:00                      
701592           4           01-JAN-2015 00:00:00                      
702995           4           01-JAN-2015 00:00:00                      
701596           4           01-JAN-2015 00:00:00                      
701603           4           01-JAN-2015 00:00:00                      
701604           4           01-JAN-2015 00:00:00                      
701610           4           01-JAN-2015 00:00:00                      
701614           4           01-JAN-2015 00:00:00                      
701632           4           01-JAN-2015 00:00:00                      
701635           4           01-JAN-2015 00:00:00                      
701646           4           01-JAN-2015 00:00:00                      
701652           4           01-JAN-2015 00:00:00                      
701657           4           01-JAN-2015 00:00:00                      
701665           4           01-JAN-2015 00:00:00                      
701671           4           01-JAN-2015 00:00:00                      
701676           4           01-JAN-2015 00:00:00                      
701686           4           01-JAN-2015 00:00:00                      
701699           4           01-JAN-2015 00:00:00                      
701700           4           01-JAN-2015 00:00:00                      
768847           4           01-JAN-2015 00:00:00                      
768854           4           01-JAN-2015 00:00:00                      
768858           4           01-JAN-2015 00:00:00                      
768861           4           01-JAN-2015 00:00:00                      
768868           4           01-JAN-2015 00:00:00                      
768871           4           01-JAN-2015 00:00:00                      
768874           4           01-JAN-2015 00:00:00                      
768877           4           01-JAN-2015 00:00:00                      
768880           4           01-JAN-2015 00:00:00                      
768886           4           01-JAN-2015 00:00:00                      
768895           4           01-JAN-2015 00:00:00                      
768901           4           01-JAN-2015 00:00:00                      
768904           4           01-JAN-2015 00:00:00                      
768907           4           01-JAN-2015 00:00:00                      
768909           4           01-JAN-2015 00:00:00                      
768916           4           01-JAN-2015 00:00:00                      
701683           5           09-JAN-2015 00:00:00                      
701521           4           01-JAN-2015 00:00:00                      
701522           4           01-JAN-2015 00:00:00                      
701525           4           01-JAN-2015 00:00:00                      
701529           4           01-JAN-2015 00:00:00                      
701530           4           01-JAN-2015 00:00:00                      
701531           4           01-JAN-2015 00:00:00                      
701533           4           01-JAN-2015 00:00:00                      
701536           4           01-JAN-2015 00:00:00                      
701545           4           01-JAN-2015 00:00:00                      
701550           4           01-JAN-2015 00:00:00                      
701555           4           01-JAN-2015 00:00:00                      
701556           4           01-JAN-2015 00:00:00                      
701557           4           01-JAN-2015 00:00:00                      
702966           4           01-JAN-2015 00:00:00                      
702968           4           01-JAN-2015 00:00:00                      
701571           4           01-JAN-2015 00:00:00                      
701586           4           01-JAN-2015 00:00:00                      
701587           4           01-JAN-2015 00:00:00                      
701588           4           01-JAN-2015 00:00:00                      
702992           4           01-JAN-2015 00:00:00                      
701597           4           01-JAN-2015 00:00:00                      
701600           4           01-JAN-2015 00:00:00                      
701605           4           01-JAN-2015 00:00:00                      
701626           4           01-JAN-2015 00:00:00                      
701642           4           01-JAN-2015 00:00:00                      
701648           4           01-JAN-2015 00:00:00                      
701654           4           01-JAN-2015 00:00:00                      
701662           4           01-JAN-2015 00:00:00                      
701668           4           01-JAN-2015 00:00:00                      
701673           4           01-JAN-2015 00:00:00                      
701680           4           01-JAN-2015 00:00:00                      
701691           4           01-JAN-2015 00:00:00                      
701694           4           01-JAN-2015 00:00:00                      
701696           4           01-JAN-2015 00:00:00                      
768846           4           01-JAN-2015 00:00:00                      
768853           4           01-JAN-2015 00:00:00                      
768857           4           01-JAN-2015 00:00:00                      
768875           4           01-JAN-2015 00:00:00                      
768883           4           01-JAN-2015 00:00:00                      
768890           4           01-JAN-2015 00:00:00                      
768894           4           01-JAN-2015 00:00:00                      
768906           4           01-JAN-2015 00:00:00                      
768908           4           01-JAN-2015 00:00:00                      
768910           4           01-JAN-2015 00:00:00                      
768913           4           01-JAN-2015 00:00:00                      
768918           4           01-JAN-2015 00:00:00                      
703543           4           01-JAN-2015 00:00:00                      
703554           4           01-JAN-2015 00:00:00                      
703564           4           01-JAN-2015 00:00:00                      
701630           4           01-JAN-2015 00:00:00                      
703553           4           01-JAN-2015 00:00:00                      
703559           4           01-JAN-2015 00:00:00                      
703563           4           01-JAN-2015 00:00:00                      
701601           5           09-JAN-2015 00:00:00                      
701658           4           01-JAN-2015 00:00:00                      
701659           4           01-JAN-2015 00:00:00                      
703550           4           01-JAN-2015 00:00:00                      
703556           4           01-JAN-2015 00:00:00                      
703565           4           01-JAN-2015 00:00:00                      
701508           4           01-JAN-2015 00:00:00                      
701514           4           01-JAN-2015 00:00:00                      
701517           4           01-JAN-2015 00:00:00                      
701543           4           01-JAN-2015 00:00:00                      
701546           4           01-JAN-2015 00:00:00                      
702961           4           01-JAN-2015 00:00:00                      
702967           4           01-JAN-2015 00:00:00                      
702970           4           01-JAN-2015 00:00:00                      
701570           4           01-JAN-2015 00:00:00                      
702975           4           01-JAN-2015 00:00:00                      
702976           4           01-JAN-2015 00:00:00                      
702977           4           01-JAN-2015 00:00:00                      
702981           4           01-JAN-2015 00:00:00                      
701582           4           01-JAN-2015 00:00:00                      
701583           4           01-JAN-2015 00:00:00                      
701589           4           01-JAN-2015 00:00:00                      
702990           4           01-JAN-2015 00:00:00                      
701593           4           01-JAN-2015 00:00:00                      
701594           4           01-JAN-2015 00:00:00                      
702996           4           01-JAN-2015 00:00:00                      
702997           4           01-JAN-2015 00:00:00                      
701607           4           01-JAN-2015 00:00:00                      
701615           4           01-JAN-2015 00:00:00                      
701623           4           01-JAN-2015 00:00:00                      
701625           4           01-JAN-2015 00:00:00                      
701629           4           01-JAN-2015 00:00:00                      
701638           4           01-JAN-2015 00:00:00                      
701640           4           01-JAN-2015 00:00:00                      
701644           4           01-JAN-2015 00:00:00                      
701649           4           01-JAN-2015 00:00:00                      
701655           4           01-JAN-2015 00:00:00                      
701663           4           01-JAN-2015 00:00:00                      
701669           4           01-JAN-2015 00:00:00                      
701674           4           01-JAN-2015 00:00:00                      
701681           4           01-JAN-2015 00:00:00                      
701684           4           01-JAN-2015 00:00:00                      
701685           4           01-JAN-2015 00:00:00                      
701689           4           01-JAN-2015 00:00:00                      
701697           4           01-JAN-2015 00:00:00                      
768845           4           01-JAN-2015 00:00:00                      
768849           4           01-JAN-2015 00:00:00                      
768851           4           01-JAN-2015 00:00:00                      
768852           4           01-JAN-2015 00:00:00                      
768859           4           01-JAN-2015 00:00:00                      
768860           4           01-JAN-2015 00:00:00                      
768864           4           01-JAN-2015 00:00:00                      
768865           4           01-JAN-2015 00:00:00                      
768882           4           01-JAN-2015 00:00:00                      
768889           4           01-JAN-2015 00:00:00                      
768892           4           01-JAN-2015 00:00:00                      
768926           4           01-JAN-2015 00:00:00                      
768920           4           01-JAN-2015 00:00:00                      
768921           4           01-JAN-2015 00:00:00                      
768914           4           01-JAN-2015 00:00:00                      
768917           4           01-JAN-2015 00:00:00                      
701631           5           21-JAN-2015 00:00:00                      

 286 rows selected 
*/

UPDATE STATUS
   SET EXPIRATION_DATE = EFFECTIVE_DATE
 WHERE COST_CENTER_CODE IN 
('701508','701509','701510','701511','701512','701513','701514','701515','701516','701517','701518','701519','701520','701521','701522','701523','701524','701525',
'701526','701529','701530','701531','701533','701534','701535','701536','701537','701538','701539','701541','701542','701543','701544','701545','701546','701548',
'701549','701550','701551','701552','701553','701554','701555','701556','701557','701559','701560','701561','701564','701567','701570','701571','701572','701573',
'701574','701576','701577','701578','701579','701580','701581','701582','701583','701586','701587','701588','701589','701590','701591','701592','701593','701594',
'701595','701596','701597','701598','701600','701601','701602','701603','701604','701605','701606','701607','701608','701609','701610','701612','701613','701614',
'701615','701616','701617','701618','701619','701622','701623','701624','701625','701626','701629','701630','701631','701632','701633','701634','701635','701636',
'701638','701640','701641','701642','701644','701645','701646','701647','701648','701649','701651','701652','701653','701654','701655','701656','701657','701658',
'701659','701660','701661','701662','701663','701664','701665','701667','701668','701669','701670','701671','701672','701673','701674','701675','701676','701677',
'701680','701681','701682','701683','701684','701685','701686','701689','701690','701691','701692','701693','701694','701696','701697','701699','701700','701701',
'702960','702961','702963','702964','702965','702966','702967','702968','702969','702970','702971','702974','702975','702976','702977','702978','702980','702981',
'702982','702983','702985','702988','702989','702990','702991','702992','702995','702996','702997','703542','703543','703546','703550','703552','703553','703554',
'703555','703556','703557','703559','703561','703562','703563','703564','703565','703566','703569','768845','768846','768847','768849','768850','768851','768852',
'768853','768854','768855','768856','768857','768858','768859','768860','768861','768862','768863','768864','768865','768866','768867','768868','768869','768870',
'768871','768872','768873','768874','768875','768876','768877','768878','768879','768880','768881','768882','768883','768884','768885','768886','768887','768888',
'768889','768890','768892','768893','768894','768895','768896','768897','768901','768903','768904','768905','768906','768907','768908','768909','768910','768911',
'768913','768914','768916','768917','768918','768919','768920','768921','768922','768923','768924','768925','768926','768928','768930','768931')
AND EXPIRATION_DATE IS NULL;

INSERT INTO STATUS
SELECT COST_CENTER_CODE,
       '1' STATUS_CODE,
       --'02-JAN-2015' EFFECTIVE_DATE,
       (SELECT MAX(EFFECTIVE_DATE)+1
          FROM STATUS
         WHERE COST_CENTER_CODE = CC.COST_CENTER_CODE) EFFECTIVE_DATE,
       NULL EXPIRATION_DATE
  FROM COST_CENTER CC
 WHERE COST_CENTER_CODE IN 
('701508','701509','701510','701511','701512','701513','701514','701515','701516','701517','701518','701519','701520','701521','701522','701523','701524','701525',
'701526','701529','701530','701531','701533','701534','701535','701536','701537','701538','701539','701541','701542','701543','701544','701545','701546','701548',
'701549','701550','701551','701552','701553','701554','701555','701556','701557','701559','701560','701561','701564','701567','701570','701571','701572','701573',
'701574','701576','701577','701578','701579','701580','701581','701582','701583','701586','701587','701588','701589','701590','701591','701592','701593','701594',
'701595','701596','701597','701598','701600','701601','701602','701603','701604','701605','701606','701607','701608','701609','701610','701612','701613','701614',
'701615','701616','701617','701618','701619','701622','701623','701624','701625','701626','701629','701630','701631','701632','701633','701634','701635','701636',
'701638','701640','701641','701642','701644','701645','701646','701647','701648','701649','701651','701652','701653','701654','701655','701656','701657','701658',
'701659','701660','701661','701662','701663','701664','701665','701667','701668','701669','701670','701671','701672','701673','701674','701675','701676','701677',
'701680','701681','701682','701683','701684','701685','701686','701689','701690','701691','701692','701693','701694','701696','701697','701699','701700','701701',
'702960','702961','702963','702964','702965','702966','702967','702968','702969','702970','702971','702974','702975','702976','702977','702978','702980','702981',
'702982','702983','702985','702988','702989','702990','702991','702992','702995','702996','702997','703542','703543','703546','703550','703552','703553','703554',
'703555','703556','703557','703559','703561','703562','703563','703564','703565','703566','703569','768845','768846','768847','768849','768850','768851','768852',
'768853','768854','768855','768856','768857','768858','768859','768860','768861','768862','768863','768864','768865','768866','768867','768868','768869','768870',
'768871','768872','768873','768874','768875','768876','768877','768878','768879','768880','768881','768882','768883','768884','768885','768886','768887','768888',
'768889','768890','768892','768893','768894','768895','768896','768897','768901','768903','768904','768905','768906','768907','768908','768909','768910','768911',
'768913','768914','768916','768917','768918','768919','768920','768921','768922','768923','768924','768925','768926','768928','768930','768931');

COMMIT;
