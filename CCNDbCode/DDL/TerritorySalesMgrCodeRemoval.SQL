--Delete the duplicate sales manager records, if any
DELETE FROM TERRITORY WHERE 
TERRITORY_SLS_MGR_CODE = '@@@@@@' AND 
COST_CENTER_CODE IN (SELECT COST_CENTER_CODE FROM TERRITORY GROUP BY COST_CENTER_CODE HAVING COUNT(*) > 1);

--create back-up tables for future reference into past data
CREATE TABLE TERRITORY_SALES_MGR_BKUP AS SELECT * FROM TERRITORY_SALES_MGR;
CREATE TABLE TERRITORY_BKUP AS SELECT * FROM TERRITORY;
CREATE TABLE TERRITORY_ASSIGNMENT_BKUP AS SELECT * FROM TERRITORY_ASSIGNMENT;

--drop the existing tables
DROP TABLE TERRITORY_ASSIGNMENT;
DROP TABLE TERRITORY;
DROP TABLE TERRITORY_SALES_MGR;

--re create the table without sales manager column
CREATE TABLE TERRITORY
   (	COST_CENTER_CODE VARCHAR2(6) NOT NULL ENABLE, 
	CATEGORY VARCHAR2(1) NOT NULL ENABLE, 
	LEASE_CAR_INDICATOR VARCHAR2(1), 
	TERRITORY_TYPE_BUSN_CODE VARCHAR2(2), 
	HOME_STORE VARCHAR2(6), 
	 CONSTRAINT TERRITORY_PK PRIMARY KEY (COST_CENTER_CODE) ENABLE, 
	 CONSTRAINT COST_CENTER_TERRITORY FOREIGN KEY (COST_CENTER_CODE) REFERENCES COST_CENTER (COST_CENTER_CODE) ENABLE
   ) ;

--insert the data from the back-up without sales manager column
INSERT INTO TERRITORY SELECT COST_CENTER_CODE, CATEGORY, LEASE_CAR_INDICATOR, TERRITORY_TYPE_BUSN_CODE, HOME_STORE FROM TERRITORY_BKUP;

COMMIT;
