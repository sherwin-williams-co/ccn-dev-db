CREATE OR REPLACE VIEW COST_POS_VIEW
AS 
  SELECT DISTINCT CC.COST_CENTER_CODE , 
                CC.COST_CENTER_NAME, 
                ADDRESS.ADDRESS_LINE_1,
                ADDRESS.ADDRESS_LINE_2, 
                ADDRESS.ADDRESS_LINE_3, 
                H.HRCHY_DTL_CURR_LVL_VAL,
                P.PHONE_AREA_CODE, 
                P.PHONE_NUMBER,
                CC.STATEMENT_TYPE, 
                T.TYPE_CODE 
                FROM COST_CENTER CC,
                     (SELECT ADDRESS_LINE_1, ADDRESS_LINE_2, ADDRESS_LINE_3, COST_CENTER_CODE FROM ADDRESS_USA WHERE ADDRESS_TYPE = 'P'
                     UNION ALL
                     SELECT ADDRESS_LINE_1, ADDRESS_LINE_2, ADDRESS_LINE_3, COST_CENTER_CODE FROM ADDRESS_CAN WHERE ADDRESS_TYPE = 'P'
                     UNION ALL
                     SELECT ADDRESS_LINE_1, ADDRESS_LINE_2, ADDRESS_LINE_3, COST_CENTER_CODE FROM ADDRESS_MEX WHERE ADDRESS_TYPE = 'P'
                     UNION ALL
                     SELECT ADDRESS_LINE_1, ADDRESS_LINE_2, ADDRESS_LINE_3, COST_CENTER_CODE FROM ADDRESS_OTHER WHERE ADDRESS_TYPE = 'P') ADDRESS,
                     PHONE P,
                     TYPE T, 
                     HIERARCHY_DETAIL H 
              WHERE CC.COST_CENTER_CODE = ADDRESS.COST_CENTER_CODE
              AND CC.COST_CENTER_CODE  = P.COST_CENTER_CODE
              AND CC.COST_CENTER_CODE  = T.COST_CENTER_CODE
              AND CC.COST_CENTER_CODE = H.HRCHY_DTL_CURR_ROW_VAL
              AND H.HRCHY_HDR_NAME = 'GLOBAL_HIERARCHY';
 
