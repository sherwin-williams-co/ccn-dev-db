  CREATE OR REPLACE VIEW ADMINORG_HIERARCHY_ATTRBT_VW ("STATEMENT_TYPE", "HRCHY_HDR_NAME", "COST_CENTER_CODE", "HRCHY_DTL_EFF_DATE", "HRCHY_DTL_EXP_DATE", "DOMAIN", "GROUP", "DIVISION", "AREA", "DISTRICT", "CITY_SALES_MANAGER", "ZONE", "COST_CENTER", "DOMAIN_NAME", "GROUP_NAME", "DIVISION_NAME", "AREA_NAME", "DISTRICT_NAME", "CITY_SALES_MANAGER_NAME", "ZONE_NAME", "COST_CENTER_NAME", "DOMAIN_EMP_NAME", "DOMAIN_EMP_GENS_ID", "GROUP_EMP_NAME", "GROUP_EMP_GEMS_ID", "DIV_EMP_NAME", "DIV_EMP_GEMS_ID", "AREA_EMP_NAME", "AREA_EMP_GEMS_ID", "DISTRICT_EMP_NAME", "DISTRICT_EMP_GEMS_ID", "CITY_EMP_NAME", "CITY_EMP_GEMS_ID", "ZONE_EMP_NAME", "ZONE_EMP_GEMS_ID", "CC_MGR_NAME", "DOMAIN_UPPER_VALUE", "GROUP_UPPER_VALUE", "DIV_UPPER_VALUE", "AREA_UPPER_VALUE", "DISTRICT_UPPER_VALUE", "CITY_UPPER_VALUE", "ZONE_UPPER_VALUE", "CC_UPPER_LVL_VALUE") AS 
  SELECT 
/*******************************************************************************
This View holds all the details of adminorg hierarchy linked to the cost center i.e. this view will 
have all the details of each and every level of the adminorg hierarchy for a particular cost center.
It will also have all the upper level value attributes in separate columns for each level (1-8).

Created  : 01/09/2017 vxv336 CCN Project
Modified : 
*******************************************************************************/
       A.STATEMENT_TYPE,
       A.HRCHY_HDR_NAME,
       A.COST_CENTER_CODE,
       A.HRCHY_DTL_EFF_DATE,
       A.HRCHY_DTL_EXP_DATE,
       A.DOMAIN,
       A."GROUP",
       A.DIVISION,
       A.AREA,
       A.DISTRICT,
       A.CITY_SALES_MANAGER,
       A."ZONE",
       A.COST_CENTER,
       A.DOMAIN_NAME,
       A.GROUP_NAME,
       A.DIVISION_NAME,
       A.AREA_NAME,
       A.DISTRICT_NAME,
       A.CITY_SALES_MANAGER_NAME,
       A.ZONE_NAME,
       A.COST_CENTER_NAME,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.DOMAIN_UPPER_VALUE, 'EmployeeName') DOMAIN_EMP_NAME,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.DOMAIN_UPPER_VALUE, 'GEMS_ID') DOMAIN_EMP_GEMS_ID,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.GROUP_UPPER_VALUE, 'EmployeeName') GROUP_EMP_NAME,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.GROUP_UPPER_VALUE, 'GEMS_ID') GROUP_EMP_GEMS_ID,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.DIV_UPPER_VALUE, 'EmployeeName') DIV_EMP_NAME,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.DIV_UPPER_VALUE, 'GEMS_ID') DIV_EMP__GEMS_ID,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.AREA_UPPER_VALUE, 'EmployeeName') AREA_EMP_NAME,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.AREA_UPPER_VALUE, 'GEMS_ID') AREA_EMP_GEMS_ID,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.DISTRICT_UPPER_VALUE, 'EmployeeName') DISTRICT_EMP_NAME,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.DISTRICT_UPPER_VALUE, 'GEMS_ID') DISTRICT_EMP_GEMS_ID,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.CITY_UPPER_VALUE, 'EmployeeName') CITY_EMP_NAME,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.CITY_UPPER_VALUE, 'GEMS_ID') CITY_EMP_GEMS_ID,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.ZONE_UPPER_VALUE, 'EmployeeName') ZONE_EMP_NAME,
       CCN_HIERARCHY.GET_RQSTD_ATTRIBUTE_VALUE(A.ZONE_UPPER_VALUE, 'GEMS_ID') ZONE_EMP_GEMS_ID,
       A.CC_MGR_NAME,
       A.DOMAIN_UPPER_VALUE,
       A.GROUP_UPPER_VALUE,
       A.DIV_UPPER_VALUE,
       A.AREA_UPPER_VALUE,
       A.DISTRICT_UPPER_VALUE,
       A.CITY_UPPER_VALUE,
       A.ZONE_UPPER_VALUE,
       A.CC_UPPER_LVL_VALUE
  FROM (SELECT AV.*,
               CCN_EMPLOYEE_DETAILS_PKG.GET_STORE_MANAGER_NAME_FNC(AV.COST_CENTER_CODE) CC_MGR_NAME,
               COMMON_TOOLS.GET_UPPER_LVL_VER_VALUE(AV.HRCHY_HDR_NAME, AV.DOMAIN, AV.DOMAIN||AV."GROUP", '~~~') DOMAIN_UPPER_VALUE,
               COMMON_TOOLS.GET_UPPER_LVL_VER_VALUE(AV.HRCHY_HDR_NAME, AV.DOMAIN||AV."GROUP", AV.DOMAIN||AV."GROUP"||AV.DIVISION, AV.DOMAIN) GROUP_UPPER_VALUE,
               COMMON_TOOLS.GET_UPPER_LVL_VER_VALUE(AV.HRCHY_HDR_NAME, AV.DOMAIN||AV."GROUP"||AV.DIVISION, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA, AV.DOMAIN||AV."GROUP") DIV_UPPER_VALUE,
               COMMON_TOOLS.GET_UPPER_LVL_VER_VALUE(AV.HRCHY_HDR_NAME, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT, AV.DOMAIN||AV."GROUP"||AV.DIVISION) AREA_UPPER_VALUE,
               COMMON_TOOLS.GET_UPPER_LVL_VER_VALUE(AV.HRCHY_HDR_NAME, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT||AV.CITY_SALES_MANAGER, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA) DISTRICT_UPPER_VALUE,
               COMMON_TOOLS.GET_UPPER_LVL_VER_VALUE(AV.HRCHY_HDR_NAME, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT||AV.CITY_SALES_MANAGER, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT||AV.CITY_SALES_MANAGER||AV."ZONE", AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT) CITY_UPPER_VALUE,
               COMMON_TOOLS.GET_UPPER_LVL_VER_VALUE(AV.HRCHY_HDR_NAME, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT||AV.CITY_SALES_MANAGER||AV."ZONE", AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT||AV.CITY_SALES_MANAGER||AV."ZONE", AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT||AV.CITY_SALES_MANAGER) ZONE_UPPER_VALUE,
               COMMON_TOOLS.GET_UPPER_LVL_VER_VALUE(AV.HRCHY_HDR_NAME, AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT||AV.CITY_SALES_MANAGER||AV."ZONE"||AV.COST_CENTER_CODE, '~~~', AV.DOMAIN||AV."GROUP"||AV.DIVISION||AV.AREA||AV.DISTRICT||AV.CITY_SALES_MANAGER||AV."ZONE") CC_UPPER_LVL_VALUE
          FROM HIERARCHY_DETAIL_VIEW AV
         WHERE AV.HRCHY_HDR_NAME = 'ADMINORG_HIERARCHY') A;
