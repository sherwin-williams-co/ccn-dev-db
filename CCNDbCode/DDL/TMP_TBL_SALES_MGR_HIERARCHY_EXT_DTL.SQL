BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE SALES_MGR_HIERARCHY_EXT_DTL';
EXCEPTION WHEN OTHERS THEN NULL;
END;
/

  CREATE TABLE SALES_MGR_HIERARCHY_EXT_DTL 
   (	HRCHY_HDR_NAME VARCHAR2(100 BYTE), 
	HRCHY_DTL_LEVEL VARCHAR2(2 BYTE), 
	HRCHY_DTL_PREV_LVL_VAL VARCHAR2(1000 BYTE), 
	HRCHY_DTL_CURR_LVL_VAL VARCHAR2(1000 BYTE), 
	HRCHY_DTL_NEXT_LVL_VAL VARCHAR2(1000 BYTE), 
	HRCHY_DTL_EFF_DATE DATE, 
	HRCHY_DTL_EXP_DATE VARCHAR2(1000 BYTE), 
	HRCHY_DTL_DESC VARCHAR2(100 BYTE), 
	UPPER_LVL_VER_VALUE VARCHAR2(1000 BYTE)
   ) 
   ORGANIZATION EXTERNAL 
    ( TYPE ORACLE_LOADER
      DEFAULT DIRECTORY CCN_DATAFILES
      ACCESS PARAMETERS
      ( records delimited by newline 
         FIELDS TERMINATED BY '~' 
         LRTRIM
         missing field values are null 
         ( 
           HRCHY_HDR_NAME,
	   HRCHY_DTL_LEVEL,
	   HRCHY_DTL_PREV_LVL_VAL,
	   HRCHY_DTL_CURR_LVL_VAL,
	   HRCHY_DTL_NEXT_LVL_VAL,
	   HRCHY_DTL_EFF_DATE DATE 'YYYYMMDD',
	   HRCHY_DTL_EXP_DATE,
	   HRCHY_DTL_DESC,
           UPPER_LVL_VER_VALUE
         ) 
                       )
      LOCATION
       ( 'sales_manager_hierarchy.txt'
       )
    )
   REJECT LIMIT UNLIMITED 
  PARALLEL ;
