BEGIN
EXECUTE IMMEDIATE 'DROP TABLE ADMINORG_HIERARCHY_EXT_DETAIL';
EXCEPTION
WHEN OTHERS THEN
NULL;
END;
/

CREATE TABLE ADMINORG_HIERARCHY_EXT_DETAIL
(
  HRCHY_HDR_NAME          VARCHAR2(100),
  HRCHY_DTL_LEVEL         VARCHAR2(2),
  HRCHY_DTL_PREV_LVL_VAL  VARCHAR2(1000),
  HRCHY_DTL_CURR_LVL_VAL  VARCHAR2(1000),
  HRCHY_DTL_NEXT_LVL_VAL  VARCHAR2(1000),
  HRCHY_DTL_EFF_DATE      DATE,
  HRCHY_DTL_EXP_DATE      DATE,
  HRCHY_DTL_DESC          VARCHAR2(100),
  UPPER_LVL_VER_VALUE     VARCHAR2(1000)
)
ORGANIZATION EXTERNAL
  (  TYPE ORACLE_LOADER
     DEFAULT DIRECTORY CCN_DATAFILES
     ACCESS PARAMETERS 
       ( RECORDS DELIMITED BY NEWLINE 
         FIELDS TERMINATED BY '~' 
         LRTRIM
         MISSING FIELD VALUES ARE NULL 
         ( 
           HRCHY_HDR_NAME,
           HRCHY_DTL_LEVEL,
           HRCHY_DTL_PREV_LVL_VAL,
           HRCHY_DTL_CURR_LVL_VAL,
           HRCHY_DTL_NEXT_LVL_VAL,
           HRCHY_DTL_EFF_DATE DATE 'YYYYMMDD',
           HRCHY_DTL_EXP_DATE DATE 'YYYYMMDD',
           HRCHY_DTL_DESC,
           UPPER_LVL_VER_VALUE
         ) 
                 )
     LOCATION (CCN_DATAFILES:'RDBA7000_ADMINORG_HIERARCH.TXT')
  )
REJECT LIMIT 0;
