create or replace PACKAGE BODY CCN_BATCH_PROCESS AS
/*********************************************************** 
This package body will have procedures and functions related 
to the batch process

Created  : 04/04/2016 nxk927 CCN project
Modified : 
************************************************************/
  
PROCEDURE NEWLY_CRTD_COST_CENTER
/**********************************************************
	This procedure is intended to generate a file with the list of new cost centers
  created on previous day

Created : 04/04/2016 nxk927 CCN project
**********************************************************/
IS
 	V_CLOB        CLOB;

BEGIN
   FOR REC IN (SELECT * 
                 FROM COST_CENTER 
                WHERE OPEN_DATE = TRUNC(SYSDATE) -1
                  AND OPEN_DATE <> '01-JAN-2099') LOOP
       V_CLOB := REC.COST_CENTER_CODE 
                 || ',' || REC.COST_CENTER_NAME 
                 || ',' || REC.OPEN_DATE
                 || CHR(10)
                 || V_CLOB;
                 
   END LOOP;
   	
   IF V_CLOB <> EMPTY_CLOB() THEN
      MAIL_PKG.SEND_MAIL('NEWLY_CRTD_COST_CENTER', NULL, NULL,V_CLOB);
   END IF;

END NEWLY_CRTD_COST_CENTER;   
END CCN_BATCH_PROCESS;