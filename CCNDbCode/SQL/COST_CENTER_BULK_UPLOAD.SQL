PROCEDURE COST_CENTER_BULK_UPLOAD AS

   V_CLOB CLOB;

   FUNCTION BUILD_TAG(IN_VALUE     IN VARCHAR2,
                      IN_TAG_NAME  IN VARCHAR2,
                      IN_DATE_IND  IN VARCHAR2)
   RETURN VARCHAR2 IS
   V_VALUE VARCHAR2(10000);
   BEGIN
      IF IN_VALUE IS NULL THEN
         RETURN '<' || IN_TAG_NAME || '/>';
      END IF;
      RETURN '<' || IN_TAG_NAME || '>' || IN_VALUE || '</' || IN_TAG_NAME || '>';
   END BUILD_TAG;
   
PROCEDURE LOG_ERROR(IN_CC      IN VARCHAR2,
                       IN_SQLERRM IN VARCHAR2,
                       IN_SQLCODE IN NUMBER) IS PRAGMA AUTONOMOUS_TRANSACTION;
   BEGIN
      INSERT INTO ERROR_LOG VALUES(ERROR_LOG_SEQ.NEXTVAL, IN_CC, SYSDATE, 'COST_CENTER_BULK_UPLOAD', IN_SQLERRM, NULL, IN_SQLCODE);
      COMMIT;
   EXCEPTION
      WHEN OTHERS THEN
         RAISE;
   END LOG_ERROR;

BEGIN
   FOR rec IN (SELECT * FROM COST_CENTER_B1 WHERE ACTV_IND = 'Y') LOOP
      SAVEPOINT COST_CENTER_LOAD;
      V_CLOB := '<COST_CENTER_UI xmlns:xsi="http://www.w3.org/2001/XMLSchema" xsi:nonamespaceSchemaLocation="http://www.oracle.com/Employee.xsd">';

      V_CLOB := V_CLOB || '<COST_CENTER>';
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_NAME, 'COST_CENTER_NAME', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.CATEGORY, 'CATEGORY', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.ENTITY_TYPE, 'ENTITY_TYPE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.STATEMENT_TYPE, 'STATEMENT_TYPE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.COUNTRY_CODE, 'COUNTRY_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.TRANSPORT_TYPE, 'TRANSPORT_TYPE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.BEGIN_DATE,'MM-DD-RRRR'), 'BEGIN_DATE', 'Y');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.OPEN_DATE,'MM-DD-RRRR'), 'OPEN_DATE', 'Y');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.MOVE_DATE, 'MM-DD-RRRR'),'MOVE_DATE', 'Y');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.CLOSE_DATE, 'MM-DD-RRRR'),'CLOSE_DATE', 'Y');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.FINANCIAL_CLOSE_DATE, 'MM-DD-RRRR'),'FINANCIAL_CLOSE_DATE', 'Y');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.POS_PROG_VER_EFF_DATE, 'MM-DD-RRRR'),'POS_PROG_VER_EFF_DATE', 'Y');
      V_CLOB := V_CLOB || BUILD_TAG(rec.UPS_ZONE_CODE, 'UPS_ZONE_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.RPS_ZONE_CODE, 'RPS_ZONE_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.CURRENCY_CODE, 'CURRENCY_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.POS_PROG_VER_NBR, 'POS_PROG_VER_NBR', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.LEASE_OWN_CODE, 'LEASE_OWN_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.MISSION_TYPE_CODE, 'MISSION_TYPE_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.DUNS_NUMBER, 'DUNS_NUMBER', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.PRI_LOGO_GROUP_IND, 'PRI_LOGO_GROUP_IND', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.SCD_LOGO_GROUP_IND, 'SCD_LOGO_GROUP_IND', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.BANKING_TYPE, 'BANKING_TYPE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.DEPOSIT_BAG_REORDER, 'DEPOSIT_BAG_REORDER', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.DEPOSIT_TICKET_REORDER, 'DEPOSIT_TICKET_REORDER', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.POP_KIT_CODE, 'POP_KIT_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.GLOBAL_HIERARCHY_IND, 'GLOBAL_HIERARCHY_IND', 'N');
      V_CLOB := V_CLOB || '</COST_CENTER>';

      V_CLOB := V_CLOB || '<STATUS>';
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.STATUS_CODE, 'STATUS_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.STATUS_EFFECTIVE_DATE, 'MM-DD-RRRR'),'STATUS_EFFECTIVE_DATE', 'Y'); --DIFF
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.STATUS_EXPIRATION_DATE, 'MM-DD-RRRR'),'STATUS_EXPIRATION_DATE', 'Y');  --diff
      V_CLOB := V_CLOB || '</STATUS>';

      V_CLOB := V_CLOB || '<TYPE>';
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.TYPE_CODE, 'TYPE_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.TYPE_EFFECTIVE_DATE, 'MM-DD-RRRR'),'TYPE_EFFECTIVE_DATE', 'Y'); --DIFF
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.TYPE_EXPIRATION_DATE, 'MM-DD-RRRR'),'TYPE_EXPIRATION_DATE', 'Y');  --diff 	      
      V_CLOB := V_CLOB || '</TYPE>';

      V_CLOB := V_CLOB || '<STORE>';
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.STORE_CATEGORY, 'CATEGORY', 'N'); --diff
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.PERP_INV_START_DATE, 'MM-DD-RRRR'),'PERP_INV_START_DATE', 'Y');  	   
      V_CLOB := V_CLOB || BUILD_TAG(rec.CLASSIFICATION_CODE, 'CLASSIFICATION_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.INVENTORY_INDICATOR, 'INVENTORY_INDICATOR', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.RURAL_METRO_ZONE_CODE, 'RURAL_METRO_ZONE_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.SELLING_STORE_FLAG, 'SELLING_STORE_FLAG', 'N');      
      V_CLOB := V_CLOB || '</STORE>';

      V_CLOB := V_CLOB || '<MARKETING>';
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.MARKETING_CATEGORY, 'CATEGORY', 'N'); --diff
      V_CLOB := V_CLOB || BUILD_TAG(rec.MARKETING_TYPE, 'MARKETING_TYPE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.MKT_EFFECTIVE_DATE, 'MM-DD-RRRR'),'MKT_EFFECTIVE_DATE', 'Y'); --DIFF
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.MKT_EXPIRATION_DATE, 'MM-DD-RRRR'),'MKT_EXPIRATION_DATE', 'Y');  --diff 
      V_CLOB := V_CLOB || BUILD_TAG(rec.MKT_BRAND, 'MKT_BRAND', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.MKT_MISSION, 'MKT_MISSION', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.MKT_SALES_FLOOR_SIZE, 'MKT_SALES_FLOOR_SIZE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.MKT_WAREHOUSE_SIZE, 'MKT_WAREHOUSE_SIZE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.MKT_REAL_ESTATE_SETTING, 'MKT_REAL_ESTATE_SETTING', 'N');
      V_CLOB := V_CLOB || '</MARKETING>';

      V_CLOB := V_CLOB || '<TAXWARE>';
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.TWJ_STATE, 'TWJ_STATE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.TWJ_ZIP, 'TWJ_ZIP', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.TWJ_GEO, 'TWJ_GEO', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.TWJ_MAINTENANCE_DATE, 'MM-DD-RRRR'),'TWJ_MAINTENANCE_DATE', 'Y');
      V_CLOB := V_CLOB || BUILD_TAG(rec.TWJ_COUNTRY, 'TWJ_COUNTRY', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.TWJ_COMPANY, 'TWJ_COMPANY', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.LAST_MAINT_DATE, 'MM-DD-RRRR'),'LAST_MAINT_DATE', 'Y');
      V_CLOB := V_CLOB || BUILD_TAG(rec.LAST_MAINT_METHOD_ID, 'LAST_MAINT_METHOD_ID', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.LAST_MAINT_USER_ID, 'LAST_MAINT_USER_ID', 'N');
      V_CLOB := V_CLOB || '</TAXWARE>';
--all diff
      V_CLOB := V_CLOB || '<ADDRESS_UI_UPSERT2>';
      V_CLOB := V_CLOB || '<ADDRESS_UI_UPSERT>';
      CASE WHEN rec.COUNTRY_CODE IN ('USA','PRI') THEN
              V_CLOB := V_CLOB || '<ADDRESS_USA>';
              V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_ADDRESS_TYPE, 'ADDRESS_TYPE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.USA_EFFECTIVE_DATE, 'MM-DD-RRRR'),'USA_EFFECTIVE_DATE', 'Y'); 
              V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.USA_EXPIRATION_DATE, 'MM-DD-RRRR'),'USA_EXPIRATION_DATE', 'Y');  
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_ADDRESS_LINE_1, 'ADDRESS_LINE_1', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_ADDRESS_LINE_2, 'ADDRESS_LINE_2', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_ADDRESS_LINE_3, 'ADDRESS_LINE_3', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_CITY, 'CITY', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_STATE_CODE, 'STATE_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_ZIP_CODE, 'ZIP_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_ZIP_CODE_4, 'ZIP_CODE_4', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_COUNTY, 'COUNTY', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_FIPS_CODE, 'FIPS_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_DESTINATION_POINT, 'DESTINATION_POINT', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_CHECK_DIGIT, 'CHECK_DIGIT', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_VALID_ADDRESS, 'VALID_ADDRESS', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.USA_COUNTRY_CODE, 'COUNTRY_CODE', 'N');
              V_CLOB := V_CLOB || '</ADDRESS_USA>';
           WHEN rec.COUNTRY_CODE = 'CAN' THEN
              V_CLOB := V_CLOB || '<ADDRESS_CAN>';
              V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_ADDRESS_TYPE, 'ADDRESS_TYPE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.CAN_EFFECTIVE_DATE, 'MM-DD-RRRR'),'CAN_EFFECTIVE_DATE', 'Y'); 
              V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.CAN_EXPIRATION_DATE, 'MM-DD-RRRR'),'CAN_EXPIRATION_DATE', 'Y');  
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_ADDRESS_LINE_1, 'ADDRESS_LINE_1', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_ADDRESS_LINE_2, 'ADDRESS_LINE_2', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_ADDRESS_LINE_3, 'ADDRESS_LINE_3', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_CITY, 'CITY', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_PROVINCE_CODE, 'PROVINCE_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_POSTAL_CODE, 'POSTAL_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_VALID_ADDRESS, 'VALID_ADDRESS', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.CAN_COUNTRY_CODE, 'COUNTRY_CODE', 'N');
              V_CLOB := V_CLOB || '</ADDRESS_CAN>';
           WHEN rec.COUNTRY_CODE = 'MEX' THEN
              V_CLOB := V_CLOB || '<ADDRESS_MEX>';
              V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_ADDRESS_TYPE, 'ADDRESS_TYPE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.MEX_EFFECTIVE_DATE, 'MM-DD-RRRR'),'MEX_EFFECTIVE_DATE', 'Y'); 
              V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.MEX_EXPIRATION_DATE, 'MM-DD-RRRR'),'MEX_EXPIRATION_DATE', 'Y');  
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_ADDRESS_LINE_1, 'ADDRESS_LINE_1', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_ADDRESS_LINE_2, 'ADDRESS_LINE_2', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_ADDRESS_LINE_3, 'ADDRESS_LINE_3', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_CITY, 'CITY', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_PROVINCE_CODE, 'PROVINCE_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_POSTAL_CODE, 'POSTAL_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_VALID_ADDRESS, 'VALID_ADDRESS', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.MEX_COUNTRY_CODE, 'COUNTRY_CODE', 'N');
              V_CLOB := V_CLOB || '</ADDRESS_MEX>';
           ELSE
              V_CLOB := V_CLOB || '<ADDRESS_OTHER>';
              V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_ADDRESS_TYPE, 'ADDRESS_TYPE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.OTH_EFFECTIVE_DATE, 'MM-DD-RRRR'),'OTH_EFFECTIVE_DATE', 'Y'); 
              V_CLOB := V_CLOB || BUILD_TAG(TO_CHAR(rec.OTH_EXPIRATION_DATE, 'MM-DD-RRRR'),'OTH_EXPIRATION_DATE', 'Y');  
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_ADDRESS_LINE_1, 'ADDRESS_LINE_1', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_ADDRESS_LINE_2, 'ADDRESS_LINE_2', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_ADDRESS_LINE_3, 'ADDRESS_LINE_3', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_CITY, 'CITY', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_PROVINCE_CODE, 'PROVINCE_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_STATE_CODE, 'STATE_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_POSTAL_CODE, 'POSTAL_CODE', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_VALID_ADDRESS, 'VALID_ADDRESS', 'N');
              V_CLOB := V_CLOB || BUILD_TAG(rec.OTH_COUNTRY_CODE, 'COUNTRY_CODE', 'N');
              V_CLOB := V_CLOB || '</ADDRESS_OTHER>';
      END CASE;
      V_CLOB := V_CLOB || '</ADDRESS_UI_UPSERT>';
      V_CLOB := V_CLOB || '</ADDRESS_UI_UPSERT2>';

      V_CLOB := V_CLOB || '<PHONE_TABLE>';
      V_CLOB := V_CLOB || '<PHONE>';
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.PRI_PHONE_NUMBER_TYPE, 'PHONE_NUMBER_TYPE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.PRI_PHONE_AREA_CODE, 'PHONE_AREA_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.PRI_PHONE_NUMBER, 'PHONE_NUMBER', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.PRI_PHONE_EXTENSION, 'PHONE_EXTENSION', 'N');
      V_CLOB := V_CLOB || '</PHONE>';
      V_CLOB := V_CLOB || '<PHONE>';
      V_CLOB := V_CLOB || BUILD_TAG(REC.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.SCD_PHONE_NUMBER_TYPE, 'PHONE_NUMBER_TYPE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(REC.SCD_PHONE_AREA_CODE, 'PHONE_AREA_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(REC.SCD_PHONE_NUMBER, 'PHONE_NUMBER', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.SCD_PHONE_EXTENSION, 'PHONE_EXTENSION', 'N');
      V_CLOB := V_CLOB || '</PHONE>';
      V_CLOB := V_CLOB || '<PHONE>';
      V_CLOB := V_CLOB || BUILD_TAG(rec.COST_CENTER_CODE, 'COST_CENTER_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.FAX_PHONE_NUMBER_TYPE, 'PHONE_NUMBER_TYPE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.FAX_PHONE_AREA_CODE, 'PHONE_AREA_CODE', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.FAX_PHONE_NUMBER, 'PHONE_NUMBER', 'N');
      V_CLOB := V_CLOB || BUILD_TAG(rec.FAX_PHONE_EXTENSION, 'PHONE_EXTENSION', 'N');
      V_CLOB := V_CLOB || '</PHONE>';
      V_CLOB := V_CLOB || '</PHONE_TABLE>';
      V_CLOB := V_CLOB || '</COST_CENTER_UI>';
      BEGIN
         COST_CENTER_UPLOAD.COST_CENTER_UPSERT(V_CLOB);
         COMMIT;
      EXCEPTION
         WHEN OTHERS THEN
            --Log the Cost Center # that failed to load
            DBMS_OUTPUT.PUT_LINE(rec.COST_CENTER_CODE || ' failed to load due to ' || SQLCODE || ' - ' || SQLERRM);
            --LOG_ERROR(rec.COST_CENTER_CODE, SQLERRM, SQLCODE);
            ROLLBACK TO COST_CENTER_LOAD;
      END;
   END LOOP;
/*EXCEPTION
   WHEN OTHERS THEN
      --Log the Cost Center # that failed to load
      DBMS_OUTPUT.PUT_LINE('Failed to load due to ' || SQLCODE || ' - ' || SQLERRM);
      --LOG_ERROR('000000', SQLERRM, SQLCODE);      
      ROLLBACK TO COST_CENTER_LOAD;
      RAISE;*/
END COST_CENTER_BULK_UPLOAD;
/

