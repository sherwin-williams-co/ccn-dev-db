BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE TEMP_PAID_DETAILS_ROYAL';
EXCEPTION WHEN OTHERS THEN NULL;
END;
/

  CREATE TABLE TEMP_PAID_DETAILS_ROYAL 
   (	TRANSACTION_NUMBER VARCHAR2(5 BYTE), 
	ACCOUNT_NUMBER VARCHAR2(7 BYTE), 
	TRANSACTION_TYPE_CODE VARCHAR2(2 BYTE), 
	SUB_REPORT_CODE VARCHAR2(2 BYTE), 
	SERIAL_NUMBER_STORE VARCHAR2(4 BYTE), 
	SERIAL_NUMBER_SEQUENCE VARCHAR2(4 BYTE), 
	AMOUNT VARCHAR2(11 BYTE), 
	STATUS_FLAG VARCHAR2(2 BYTE), 
	ISSUE_DATE VARCHAR2(6 BYTE), 
	PAID_DATE VARCHAR2(6 BYTE), 
	TRANSACTION_CODE VARCHAR2(3 BYTE), 
	FILLER VARCHAR2(1 BYTE), 
	CHECK_NUMBER_CC VARCHAR2(4 BYTE), 
	CHECK_NUMBER_SQ VARCHAR2(4 BYTE), 
	CHECK_NUMBER_CK VARCHAR2(1 BYTE), 
	FILLER1 VARCHAR2(9 BYTE), 
	STATUS VARCHAR2(2 BYTE), 
	TOLERANCE_AMOUNT VARCHAR2(3 BYTE), 
	TOLERANCE_INDICATOR VARCHAR2(1 BYTE)
   ) 
   ORGANIZATION EXTERNAL 
    ( TYPE ORACLE_LOADER
      DEFAULT DIRECTORY STORDRFT_LOAD_FILES
      ACCESS PARAMETERS
      ( RECORDS DELIMITED BY NEWLINE
        badfile STORDRFT_LOAD_FILES:'TEMP_PAID_DETAILS_ROYAL.bad'
        logfile STORDRFT_LOAD_FILES:'TEMP_PAID_DETAILS_ROYAL.log'
        discardfile STORDRFT_LOAD_FILES:'TEMP_PAID_DETAILS_ROYAL.dsc'
        LOAD WHEN ((13:14) = '10' OR (13:14) = '15' OR (13:14) = '20' OR (13:14) = '30' OR (13:14) = '40' OR (13:14) = '50' OR (13:14) = '60' OR (13:14) = '70')
        FIELDS(
                TRANSACTION_NUMBER     CHAR(5), 
                ACCOUNT_NUMBER         CHAR(7), 
                TRANSACTION_TYPE_CODE  CHAR(2), 
                SUB_REPORT_CODE        CHAR(2), 
                SERIAL_NUMBER_STORE    CHAR(4), 
                SERIAL_NUMBER_SEQUENCE CHAR(4), 
                AMOUNT                 CHAR(11), 
                STATUS_FLAG            CHAR(2), 
                ISSUE_DATE             CHAR(6), 
                PAID_DATE              CHAR(6), 
                TRANSACTION_CODE       CHAR(3), 
                FILLER                 CHAR(1), 
                CHECK_NUMBER_CC        CHAR(4), 
                CHECK_NUMBER_SQ        CHAR(4), 
                CHECK_NUMBER_CK        CHAR(1), 
                FILLER1                CHAR(9), 
                STATUS                 CHAR(2), 
                TOLERANCE_AMOUNT       CHAR(3),
                TOLERANCE_INDICATOR    CHAR(1)
                            )
                        )
      LOCATION
       ( 'STBD0601_ROYALBNK_PAID2.TXT'
       )
    );
