  CREATE OR REPLACE VIEW INSTALLER_GAIN_LOSS_REPORT_HST_VW (COST_CENTER_CODE, COST_CENTER_NAME, COST_CENTER_MGR, CUSTOMER_ACCOUNT_NUMBER, PAYEE_NAME, CUSTOMER_NAME, TERMINAL_NUMBER, TRANSACTION_NUMBER, TRANSACTION_DATE, LBR_TRANSACTION_NUMBER, LBR_TERMINAL_NUMBER, LBR_TRANSACTION_DATE, DRAFT_NUMBER, DRAFT_AMOUNT, LABOR_AMOUNT, ITEM_QUANTITY, PHONE_NUMBER, AREA, AREA_NAME, AREA_MGR, DISTRICT, DISTRICT_NAME, DISTRICT_MGR, DIVISION, DIVISION_NAME, DIVISION_MGR, PL_DATE, PAYEE_ACC_NUMBER, CLOSE_DATE) AS 
  SELECT 
/***********************************************************************************************
This view holds all the required monthly installer gain and loss report data, including history

Created  : 08/08/2019 akj899 CCNSD-27 CCN Project Team....
Modified : 
************************************************************************************************/
       COST_CENTER_CODE, COST_CENTER_NAME, COST_CENTER_MGR, CUSTOMER_ACCOUNT_NUMBER, PAYEE_NAME, CUSTOMER_NAME, TERMINAL_NUMBER, TRANSACTION_NUMBER, TRANSACTION_DATE, LBR_TRANSACTION_NUMBER, LBR_TERMINAL_NUMBER, LBR_TRANSACTION_DATE, DRAFT_NUMBER, DRAFT_AMOUNT, LABOR_AMOUNT, ITEM_QUANTITY, PHONE_NUMBER, AREA, AREA_NAME, AREA_MGR, DISTRICT, DISTRICT_NAME, DISTRICT_MGR, DIVISION, DIVISION_NAME, DIVISION_MGR, PL_DATE, PAYEE_ACC_NUMBER, CLOSE_DATE
  FROM HST_SD_INSTLR_GAIN_LOSS_REPORT
 WHERE (CLOSE_DATE, RUN_NBR) IN (SELECT CLOSE_DATE, MAX(RUN_NBR) FROM HST_SD_INSTLR_GAIN_LOSS_REPORT GROUP BY CLOSE_DATE);
