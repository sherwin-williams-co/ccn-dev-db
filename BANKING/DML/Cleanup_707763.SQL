-- created by rxv940 on 01/31/2018
-- Run this in the Banking Schema
-- Moving Member 707763 details to History

INSERT INTO LEAD_BANK_CC_HIST
SELECT * 
  FROM LEAD_BANK_CC 
 WHERE LEAD_STORE_NBR = '707091' 
   AND EXPIRATION_DATE IS NOT NULL;

INSERT INTO MEMBER_BANK_CC_HIST
SELECT * 
  FROM MEMBER_BANK_CC 
 WHERE MEMBER_STORE_NBR = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;

INSERT INTO BANK_DEP_TICK_HIST
SELECT * 
  FROM BANK_DEP_TICK 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;

INSERT INTO BANK_DEP_TICKORD_HIST
SELECT * 
  FROM BANK_DEP_TICKORD 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;

INSERT INTO BANK_DEP_BAG_TICK_HIST
SELECT * 
  FROM BANK_DEP_BAG_TICK 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;

INSERT INTO BANK_DEP_BAG_TICKORD_HIST
SELECT * 
  FROM BANK_DEP_BAG_TICKORD 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;

INSERT INTO STORE_MICR_FORMAT_DTLS_HIST
SELECT * 
  FROM STORE_MICR_FORMAT_DTLS 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;

-- Purging all current records for the Member 707763
DELETE 
  FROM MEMBER_BANK_CC 
 WHERE MEMBER_STORE_NBR = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;
   
DELETE  
  FROM LEAD_BANK_CC 
 WHERE LEAD_STORE_NBR = '707091' 
   AND EXPIRATION_DATE IS NOT NULL;

DELETE 
  FROM BANK_DEP_TICK 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;
   
DELETE 
  FROM BANK_DEP_TICKORD 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;
   
DELETE 
  FROM BANK_DEP_BAG_TICK 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;
   
DELETE 
  FROM BANK_DEP_BAG_TICKORD 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;
   
DELETE 
  FROM STORE_MICR_FORMAT_DTLS 
 WHERE COST_CENTER_CODE = '707763' 
   AND EXPIRATION_DATE IS NOT NULL;
 
 -- Inserting the Member back into the MEMBER_BANK_CC table
   
INSERT INTO MEMBER_BANK_CC
  (
    LEAD_BANK_ACCOUNT_NBR
  , LEAD_STORE_NBR
  , MEMBER_STORE_NBR
  , EFFECTIVE_DATE
  , EXPIRATION_DATE
  , MEMBER_BANK_ACCOUNT_NBR
  , BANK_BRANCH_NBR
  , UPDATE_DATE
  , LAST_UPD_USER_ID
) VALUES (
    '9000434910'
  , '707091'
  , '707763'
  , TRUNC(SYSDATE)
  , NULL
  , NULL
  , NULL
  , SYSDATE
  , 'lxb8vr'
);
    
    COMMIT;
  