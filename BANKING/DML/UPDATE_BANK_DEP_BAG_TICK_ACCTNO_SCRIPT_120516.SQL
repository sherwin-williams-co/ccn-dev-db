/*******************************************************************************
The insert script is used to Update the BANK_DEP_BAG_TICKORD and BANK_DEP_TICKORD
tables data with correct account number. The correct account number is fetched from the
BANK_DEP_BAG_TICK and BANK_DEP_TICKORD tables basing upon the COST_CENTER_CODE. The
update is done basing upon the ROWID update.

Created  : 12/05/2016 MXK766 CCN Project
Modified :
*******************************************************************************/

MERGE INTO BANK_DEP_TICKORD TGT
USING
(
SELECT T1.ROWID AS TGT_ROWID, T1.COST_CENTER_CODE, T1.BANK_ACCOUNT_NBR, T2.BANK_ACCOUNT_NBR AS CORRECT_BANK_ACCOUNT_NBR
FROM BANK_DEP_TICKORD T1 ,BANK_DEP_TICK T2
WHERE T1.COST_CENTER_CODE = T2.COST_CENTER_CODE AND T1.BANK_ACCOUNT_NBR <> T2.BANK_ACCOUNT_NBR
) SRC
ON (TGT.ROWID = SRC.TGT_ROWID)
WHEN MATCHED THEN
UPDATE
SET
TGT.BANK_ACCOUNT_NBR = SRC.CORRECT_BANK_ACCOUNT_NBR;


MERGE INTO BANK_DEP_BAG_TICKORD TGT
USING
(
SELECT T1.ROWID AS TGT_ROWID, T1.COST_CENTER_CODE, T1.BANK_ACCOUNT_NBR, T2.BANK_ACCOUNT_NBR AS CORRECT_BANK_ACCOUNT_NBR
FROM BANK_DEP_BAG_TICKORD T1 ,BANK_DEP_BAG_TICK T2
WHERE T1.COST_CENTER_CODE = T2.COST_CENTER_CODE AND T1.BANK_ACCOUNT_NBR <> T2.BANK_ACCOUNT_NBR
) SRC
ON (TGT.ROWID = SRC.TGT_ROWID)
WHEN MATCHED THEN
UPDATE
SET
TGT.BANK_ACCOUNT_NBR = SRC.CORRECT_BANK_ACCOUNT_NBR;

COMMIT;