create or replace PACKAGE BODY BANKING_BATCH_PKG
AS
/**********************************************************
  This Package is a wrapper for all batch processes of banking application

Created : 07/21/2015 axk326/jxc517 CCN Project....
Changed :
**********************************************************/
PROCEDURE CURRENT_TO_HISTORY_PROCESS
/******************************************************************************
  This procedure is a wrapper to call CURRENT_TO_HISTORY_PKG.PROCESS

Created : 07/21/2015 axk326/jxc517 CCN Project....
Changed :
*******************************************************************************/
IS
BEGIN
   CURRENT_TO_HISTORY_PKG.PROCESS();
END CURRENT_TO_HISTORY_PROCESS;

PROCEDURE FUTURE_TO_CURRENT_PROCESS
/******************************************************************************
  This procedure is a wrapper to call FUTURE_TO_CURRENT_PKG.PROCESS

Created : 07/21/2015 axk326/jxc517 CCN Project....
Changed :
*******************************************************************************/
IS
BEGIN
    FUTURE_TO_CURRENT_PKG.PROCESS();
END FUTURE_TO_CURRENT_PROCESS;

PROCEDURE LOAD_MEMER_BANK_CONCENT_CC(
/*******************************************************************
  This procedure will load the data in MEMBER_BANK_CONCENTRATION_CC table.

Created : sxg151 10/30/2017
Changed : kxm302 11/12/2018 CCN Project Team...
        : Include only current transactions for concentration details ASP-1163
********************************************************************/
IN_LOAD_DATE  IN DATE)
IS
   CURSOR member_bank_cc_cur IS
      SELECT LEAD_STORE_NBR,
             Member_Store_Nbr
        FROM Member_Bank_Cc
        WHERE update_date < TRUNC(SYSDATE);
BEGIN
DELETE  FROM MEMBER_BANK_CONCENTRATION_CC WHERE LOAD_DATE = IN_LOAD_DATE;

   FOR member_bank_cc_cur_rec IN member_bank_cc_cur LOOP
       INSERT INTO MEMBER_BANK_CONCENTRATION_CC(LEAD_STORE_NBR,
                                                MEMBER_STORE_NBR,
                                                LOAD_DATE )
       VALUES(member_bank_cc_cur_rec.LEAD_STORE_NBR,
              member_bank_cc_cur_rec.MEMBER_STORE_NBR,
              IN_LOAD_DATE );
   END LOOP;
   Commit;
END LOAD_MEMER_BANK_CONCENT_CC;

END BANKING_BATCH_PKG;